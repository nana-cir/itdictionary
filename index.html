<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ITç”¨èªè¾å…¸ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§æ„å‘³ãŒå‡ºã‚‹ï¼‰</title>
  <style>
    :root{
      --bg:#f4f6f8; --card:#fff; --text:#111827; --muted:#6b7280;
      --line:#e5e7eb; --accent:#2563eb; --accent2:#16a34a;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    }
    .wrap{max-width:980px;margin:0 auto;padding:0 12px 24px}
    header{padding:16px 14px 10px}
    .title{margin:0;font-size:18px;font-weight:900}
    .sub{margin:6px 0 0;color:var(--muted);font-size:13px;line-height:1.45}

    .card{
      background:var(--card); border:1px solid var(--line);
      border-radius:16px; padding:14px; margin:12px 0;
      box-shadow:0 2px 10px rgba(0,0,0,.04);
    }

    .usage{
      border:1px solid rgba(37,99,235,.25);
      background:rgba(37,99,235,.06);
      border-radius:16px;
      padding:12px 12px;
      margin:10px 0 12px;
    }
    .usage h2{
      margin:0 0 8px; font-size:14px; font-weight:900;
      display:flex; align-items:center; gap:8px;
    }
    .usage p{margin:6px 0; color:var(--muted); font-size:13px; line-height:1.55}
    .usage ol{margin:8px 0 0 18px; padding:0; color:var(--muted); font-size:13px; line-height:1.55}
    .usage li{margin:4px 0}

    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .row>*{flex:1}
    input[type="search"]{
      width:100%; padding:12px 12px; border-radius:12px; border:1px solid var(--line);
      font-size:14px; outline:none; background:#fff;
    }
    input[type="search"]:focus{border-color:rgba(37,99,235,.45); box-shadow:0 0 0 4px rgba(37,99,235,.10)}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:9px 12px; border-radius:999px; border:1px solid var(--line);
      background:#fff; color:var(--muted); font-size:12px;
      user-select:none;
    }
    .count strong{color:var(--text)}
    .hint .kbd{
      font-family:ui-monospace,monospace; font-size:11px;
      padding:3px 7px; border:1px solid var(--line); border-bottom-width:2px;
      border-radius:8px; background:#fff; color:#111827;
    }

    .warn{
      border:1px dashed rgba(37,99,235,.35);
      background:rgba(37,99,235,.06);
      padding:10px 12px; border-radius:14px; color:var(--muted); font-size:12px; line-height:1.5;
      margin-top:10px;
      display:none;
    }

    .grid{
      display:grid; gap:10px;
      grid-template-columns: repeat( auto-fit, minmax(240px, 1fr) );
      margin-top:10px;
    }

    /* term cards using <details> (no modal) */
    details.term{
      border:1px solid var(--line); border-radius:14px;
      background:linear-gradient(180deg,#fff,#fcfcfd);
      overflow:hidden;
    }
    details.term[open]{border-color:rgba(37,99,235,.35); box-shadow:0 6px 18px rgba(37,99,235,.08)}
    summary.termHead{
      list-style:none;
      cursor:pointer;
      padding:12px;
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    }
    summary.termHead::-webkit-details-marker{display:none}
    .termTitle{
      margin:0; font-size:15px; font-weight:900; letter-spacing:.2px;
      display:flex; flex-wrap:wrap; gap:8px; align-items:center;
    }
    .badge{
      font-size:11px; padding:4px 8px; border-radius:999px;
      border:1px solid var(--line); color:var(--muted); background:#fff;
      white-space:nowrap;
    }
    .meta{
      margin-top:6px;color:var(--muted);font-size:12px;line-height:1.4
    }
    .termPreview{
      padding-left:12px; padding-right:12px; padding-bottom:12px;
      color:var(--muted); font-size:12px; line-height:1.45;
    }
    .termBody{
      border-top:1px solid var(--line);
      padding:12px;
      background:#fff;
    }
    .kvs{display:grid; gap:10px; grid-template-columns:1fr}
    .kv{border:1px solid var(--line); border-radius:14px; padding:12px; background:#fafafa}
    .kv .k{font-size:12px;color:var(--muted);margin-bottom:4px}
    .kv .v{font-size:14px;line-height:1.55}
    .tags{margin-top:6px; display:flex; flex-wrap:wrap; gap:6px}
    .tag{
      font-size:11px; padding:4px 8px; border-radius:999px;
      background:rgba(22,163,74,.10); color:var(--accent2); border:1px solid rgba(22,163,74,.20);
    }
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}

    footer{color:var(--muted); font-size:12px; padding:0 14px 20px}
  </style>
</head>
<body>
  <header class="wrap">
    <h1 class="title">ITç”¨èªè¾å…¸ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§æ„å‘³ãŒå‡ºã‚‹ï¼‰</h1>
    <p class="sub">terms.json ã‚’èª­ã¿è¾¼ã‚€è¾å…¸ã§ã™ã€‚ç”¨èªã¯ã‚«ãƒ¼ãƒ‰ã‚’é–‹ãã¨è©³ç´°ãŒè¦‹ãˆã¾ã™ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ãªã—ï¼‰ã€‚</p>

    <!-- âœ… ãƒˆãƒƒãƒ—ä¸‹ï¼šä½¿ã„æ–¹ -->
    <section class="usage" aria-label="ã“ã®è¾å…¸ã®ä½¿ã„æ–¹">
      <h2>ğŸ“˜ ã“ã®è¾å…¸ã®ä½¿ã„æ–¹</h2>
      <p>
        ã“ã®ITç”¨èªè¾å…¸ã¯ã€ITè¨˜äº‹ã‚„ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’èª­ã‚“ã§ã„ã¦ã€Œã“ã‚Œä½•ã ã£ã‘ï¼Ÿã€ã¨æ€ã£ãŸè¨€è‘‰ã‚’ã€
        ã‚ã¨ã‹ã‚‰è¦‹è¿”ã›ã‚‹ã‚ˆã†ã«ã¾ã¨ã‚ãŸè¾å…¸ã§ã™ã€‚ã‚€ãšã‹ã—ã„å°‚é–€ç”¨èªã‚’ãã®ã¾ã¾ä¸¦ã¹ã‚‹ã®ã§ã¯ãªãã€
        ã§ãã‚‹ã ã‘ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ã„è¨€è‘‰ã§èª¬æ˜ã™ã‚‹ã“ã¨ã‚’æ„è­˜ã—ã¦ã„ã¾ã™ã€‚
      </p>
      <ol>
        <li>ITè¨˜äº‹ã‚„è³‡æ–™ã‚’èª­ã‚€</li>
        <li>åˆ†ã‹ã‚‰ãªã„è¨€è‘‰ã«å‡ºä¼šã†</li>
        <li>ã“ã®è¾å…¸ã§æ¤œç´¢ã—ã¦ã¿ã‚‹</li>
        <li>ã€Œã‚ã€ãã†ã„ã†ã“ã¨ã‹ã€ã¨åˆ†ã‹ã‚Œã°OK</li>
      </ol>
      <p>
        â€» ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã‚„ä»–ã‚µã‚¤ãƒˆã®æ–‡ç« ã‚’ãã®ã¾ã¾è»¢è¼‰ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚èª¬æ˜æ–‡ã¯ã™ã¹ã¦ã‚ªãƒªã‚¸ãƒŠãƒ«ã§ã™ã€‚
      </p>
    </section>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="row">
        <input id="q" type="search" placeholder="æ¤œç´¢ï¼ˆä¾‹ï¼šAWS / ãã‚‰ã†ã© / ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ / React / CRUDï¼‰" />
        <div class="pill count">ä»¶æ•°ï¼š<strong id="count">0</strong></div>
        <div class="pill hint">æ“ä½œï¼š<span class="kbd">/</span>ã§æ¤œç´¢ã¸ / <span class="kbd">Esc</span>ã§é–‰ã˜ã‚‹</div>
      </div>

      <div id="warn" class="warn"></div>
      <div id="grid" class="grid" aria-live="polite"></div>
    </section>

    <footer>
      âœ… æ›´æ–°æ–¹æ³•ï¼šterms.json ã«è¿½è¨˜ â†’ push â†’ GitHub Pagesã‚’é–‹ã â†’ è‡ªå‹•ã§åæ˜ 
    </footer>
  </main>

<script>
(() => {
  let TERMS = [];

  const $ = (id) => document.getElementById(id);
  const grid = $("grid");
  const q = $("q");
  const count = $("count");
  const warn = $("warn");

  const normalize = (s) => (s || "")
    .toString()
    .trim()
    .toLowerCase()
    .replace(/\s+/g," ");

  function matchTerm(t, query){
    if(!query) return true;
    const hay = [
      t.term, t.yomi, t.cat,
      (t.tags || []).join(" "),
      t.desc, t.one, t.id
    ].join(" ");
    return normalize(hay).includes(normalize(query));
  }

  function escapeHtml(str){
    return (str ?? "").toString()
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function shorten(s, n){
    s = (s||"").toString();
    return s.length > n ? s.slice(0, n-1) + "â€¦" : s;
  }

  function showWarn(msg){
    warn.style.display = "block";
    warn.textContent = msg;
  }

  function render(list){
    grid.innerHTML = "";
    count.textContent = list.length;

    if(list.length === 0){
      grid.innerHTML = `
        <div style="grid-column:1/-1">
          <details class="term" open>
            <summary class="termHead">
              <div>
                <div class="termTitle">è©²å½“ãªã— <span class="badge">æ¤œç´¢ã‚’å¤‰ãˆã¦ã¿ã¦</span></div>
                <div class="meta">ä¾‹ï¼šAWS / ãã‚‰ã†ã© / ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ / React / CRUD</div>
              </div>
            </summary>
            <div class="termBody">
              <div class="kv">
                <div class="k">ãƒ’ãƒ³ãƒˆ</div>
                <div class="v">ã‚¹ãƒšãƒ¼ã‚¹ã‚„å¤§æ–‡å­—å°æ–‡å­—ã¯æ°—ã«ã›ãšæ¤œç´¢ã§ãã¾ã™ã€‚</div>
              </div>
            </div>
          </details>
        </div>
      `;
      return;
    }

    for(const t of list){
      const el = document.createElement("details");
      el.className = "term";

      const tagsHtml = (t.tags && t.tags.length)
        ? `<div class="tags">${t.tags.map(x => `<span class="tag">${escapeHtml(x)}</span>`).join("")}</div>`
        : `<div class="v">â€”</div>`;

      el.innerHTML = `
        <summary class="termHead">
          <div style="min-width:0;flex:1">
            <div class="termTitle">
              <span>${escapeHtml(t.term)}</span>
              <span class="badge">${escapeHtml(t.cat || "æœªåˆ†é¡")}</span>
            </div>
            <div class="meta">
              ${t.yomi ? `èª­ã¿ï¼š<strong>${escapeHtml(t.yomi)}</strong>` : `èª­ã¿ï¼šâ€”`}
            </div>
          </div>
          <span class="badge">é–‹ã</span>
        </summary>

        <div class="termPreview">
          ${escapeHtml(shorten(t.one || t.desc || "", 90))}
        </div>

        <div class="termBody">
          <div class="kvs">
            <div class="kv">
              <div class="k">æ„å‘³ï¼ˆè¶…ã‚„ã•ã—ã„ï¼‰</div>
              <div class="v">${escapeHtml(t.desc || "â€”")}</div>
            </div>
            <div class="kv">
              <div class="k">ã²ã¨ã“ã¨ã§ï¼ˆãŸã¨ãˆï¼‰</div>
              <div class="v">${escapeHtml(t.one || "â€”")}</div>
            </div>
            <div class="kv">
              <div class="k">é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</div>
              ${tagsHtml}
            </div>
            <div class="kv">
              <div class="k">ã“ã®è¾å…¸ã§ã®è¡¨è¨˜ï¼ˆIDï¼‰</div>
              <div class="v mono">${escapeHtml(t.id || "â€”")}</div>
            </div>
          </div>
        </div>
      `;

      // é–‹é–‰ãƒ©ãƒ™ãƒ«ã‚’ã¡ã‚‡ã„æ”¹å–„
      el.addEventListener("toggle", () => {
        const badge = el.querySelector("summary .badge:last-child");
        if (badge) badge.textContent = el.open ? "é–‰ã˜ã‚‹" : "é–‹ã";
      });

      grid.appendChild(el);
    }
  }

  // æ¤œç´¢
  q.addEventListener("input", () => {
    const query = q.value;
    const list = TERMS.filter(t => matchTerm(t, query));
    render(list);
  });

  // / ã‚­ãƒ¼ã§æ¤œç´¢ã¸ã€Escã§æ¤œç´¢è§£é™¤
  document.addEventListener("keydown", (e) => {
    if(e.key === "/"){
      const active = document.activeElement;
      const isTyping = active && (active.tagName === "INPUT" || active.tagName === "TEXTAREA");
      if(!isTyping){
        e.preventDefault();
        q.focus();
      }
    }
    if(e.key === "Escape"){
      // ã¾ãšæ¤œç´¢æ¬„ã‚’ã‚¯ãƒªã‚¢ï¼ˆå¥½ã¿ã§ï¼‰
      if(document.activeElement === q && q.value){
        q.value = "";
        render(TERMS);
        q.blur();
      }else{
        // é–‹ã„ã¦ã„ã‚‹detailsã‚’é–‰ã˜ã‚‹
        document.querySelectorAll("details.term[open]").forEach(d => d.open = false);
      }
    }
  });

  // terms.json èª­ã¿è¾¼ã¿
  async function loadTerms(){
    try{
      const res = await fetch("./terms.json", { cache:"no-store" });
      if(!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();
      if(!Array.isArray(data)) throw new Error("terms.json ãŒé…åˆ—(JSONã®[])ã«ãªã£ã¦ã„ã¾ã›ã‚“");

      TERMS = data.map(x => ({
        id: String(x.id ?? "").trim(),
        term: String(x.term ?? "").trim(),
        yomi: (x.yomi ?? "").toString().trim(),
        cat: (x.cat ?? "").toString().trim(),
        desc: (x.desc ?? "").toString().trim(),
        one: (x.one ?? "").toString().trim(),
        tags: Array.isArray(x.tags) ? x.tags.map(t => String(t)) : []
      })).filter(x => x.term);

      TERMS.sort((a,b) => (a.cat+a.term).localeCompare(b.cat+b.term, "ja"));
      render(TERMS);

    }catch(err){
      render([]);
      showWarn(
        "terms.json ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒ«ç›´é–‹ãã ã¨å¤±æ•—ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚"
        + " GitHub Pagesã§é–‹ãã‹ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ã†ã¨ç¢ºå®Ÿã§ã™ã€‚"
        + "ï¼ˆã‚¨ãƒ©ãƒ¼ï¼š" + (err?.message || err) + "ï¼‰"
      );
    }
  }

  loadTerms();
})();
</script>
</body>
</html>
